(function g(b,c,d){function a(h,i){if(!c[h]){if(!b[h]){var j="function"==typeof require&&require;if(!i&&j)return j(h,!0);if(e)return e(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var f=c[h]={exports:{}};b[h][0].call(f.exports,function(c){var d=b[h][1][c];return a(d?d:c)},f,f.exports,g,b,c,d)}return c[h].exports}for(var e="function"==typeof require&&require,f=0;f<d.length;f++)a(d[f]);return a})({1:[function(a,b){var c=Math.max,e=Math.min,f=Math.round;function g(){this.page=-1,this.pages=[],this.newPage()}function h(a,b){this.width=~~a,this.height=~~b,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=[],this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new g}var j=a("./TypedNeuQuant.js"),k=a("./LZWEncoder.js");g.pageSize=4096,g.charMap={};for(var l=0;256>l;l++)g.charMap[l]=String.fromCharCode(l);g.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(g.pageSize),this.cursor=0},g.prototype.getData=function(){for(var a="",b=0;b<this.pages.length;b++)for(var c=0;c<g.pageSize;c++)a+=g.charMap[this.pages[b][c]];return a},g.prototype.writeByte=function(a){this.cursor>=g.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a},g.prototype.writeUTFBytes=function(a){for(var b=a.length,c=0;c<b;c++)this.writeByte(a.charCodeAt(c))},g.prototype.writeBytes=function(a,b,c){for(var d=c||a.length,e=b||0;e<d;e++)this.writeByte(a[e])},h.prototype.setDelay=function(a){this.delay=f(a/10)},h.prototype.setFrameRate=function(a){this.delay=f(100/a)},h.prototype.setDispose=function(a){0<=a&&(this.dispose=a)},h.prototype.setRepeat=function(a){this.repeat=a},h.prototype.setTransparent=function(a){this.transparent=a},h.prototype.addFrame=function(a){this.image=a,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),0<=this.repeat&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},h.prototype.finish=function(){this.out.writeByte(59)},h.prototype.setQuality=function(a){1>a&&(a=1),this.sample=a},h.prototype.setDither=function(a){!0===a&&(a="FloydSteinberg"),this.dither=a},h.prototype.setGlobalPalette=function(a){this.globalPalette=a},h.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},h.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},h.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new j(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},h.prototype.indexPixels=function(){var a=this.pixels.length/3;this.indexedPixels=new Uint8Array(a);for(var b,c=0,d=0;d<a;d++)b=this.findClosestRGB(255&this.pixels[c++],255&this.pixels[c++],255&this.pixels[c++]),this.usedEntry[b]=!0,this.indexedPixels[d]=b},h.prototype.ditherPixels=function(a,b){var f={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!a||!f[a])throw"Unknown dithering kernel: "+a;var g=f[a],h=0,j=this.height,k=this.width,l=this.pixels,m=b?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var n=0;n<j;n++){b&&(m*=-1);for(var o=1==m?0:k-1,p=1==m?k:0;o!==p;o+=m){h=n*k+o;var q=3*h,r=l[q],s=l[q+1],t=l[q+2];q=this.findClosestRGB(r,s,t),this.usedEntry[q]=!0,this.indexedPixels[h]=q,q*=3;for(var u=this.colorTab[q],v=this.colorTab[q+1],w=this.colorTab[q+2],z=r-u,A=s-v,B=t-w,C=1==m?0:g.length-1,D=1==m?g.length:0;C!==D;C+=m){var E=g[C][1],F=g[C][2];if(0<=E+o&&E+o<k&&0<=F+n&&F+n<j){var G=g[C][0];q=h+E+F*k,q*=3,l[q]=c(0,e(255,l[q]+z*G)),l[q+1]=c(0,e(255,l[q+1]+A*G)),l[q+2]=c(0,e(255,l[q+2]+B*G))}}}}},h.prototype.findClosest=function(a,b){return this.findClosestRGB((16711680&a)>>16,(65280&a)>>8,255&a,b)},h.prototype.findClosestRGB=function(a,c,e,b){if(null===this.colorTab)return-1;if(this.neuQuant&&!b)return this.neuQuant.lookupRGB(a,c,e);for(var f=0,g=16777216,h=this.colorTab.length,j=0,k=0;j<h;k++){var l=a-(255&this.colorTab[j++]),m=c-(255&this.colorTab[j++]),n=e-(255&this.colorTab[j++]),o=l*l+m*m+n*n;(!b||this.usedEntry[k])&&o<g&&(g=o,f=k)}return f},h.prototype.getImagePixels=function(){var a=this.width,b=this.height;this.pixels=new Uint8Array(3*(a*b));for(var c=this.image,d=0,e=0,f=0;f<b;f++)for(var g=0;g<a;g++)this.pixels[e++]=c[d++],this.pixels[e++]=c[d++],this.pixels[e++]=c[d++],d++},h.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var a,b;null===this.transparent?(a=0,b=0):(a=1,b=2),0<=this.dispose&&(b=7&dispose),b<<=2,this.out.writeByte(0|(0|b)|a),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},h.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},h.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},h.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},h.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var a=768-this.colorTab.length,b=0;b<a;b++)this.out.writeByte(0)},h.prototype.writeShort=function(a){this.out.writeByte(255&a),this.out.writeByte(255&a>>8)},h.prototype.writePixels=function(){var a=new k(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)},h.prototype.stream=function(){return this.out},b.exports=h},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(a,b){function c(a,b,c,e){function f(a,b){u[o++]=a,254<=o&&j(b)}function g(a){h(5003),y=r+2,z=!0,m(r,a)}function h(a){for(var b=0;b<a;++b)v[b]=-1}function i(a,b){var d,e,f,j,n,t,u;for(q=a,z=!1,n_bits=q,p=k(n_bits),r=1<<a-1,s=r+1,y=r+2,o=0,j=l(),u=0,d=5003;65536>d;d*=2)++u;u=8-u,t=5003,h(t),m(r,b);outer_loop:for(;-1!=(e=l());){if(d=(e<<12)+j,f=e<<u^j,v[f]===d){j=w[f];continue}else if(0<=v[f]){n=t-f,0===f&&(n=1);do if(0>(f-=n)&&(f+=t),v[f]===d){j=w[f];continue outer_loop}while(0<=v[f])}m(j,b),j=e,4096>y?(w[f]=y++,v[f]=d):g(b)}m(j,b),m(s,b)}function j(a){0<o&&(a.writeByte(o),a.writeBytes(u,0,o),o=0)}function k(a){return(1<<a)-1}function l(){if(0===remaining)return-1;--remaining;var a=c[curPixel++];return 255&a}function m(a,b){for(n&=d[x],0<x?n|=a<<x:n=a,x+=n_bits;8<=x;)f(255&n,b),n>>=8,x-=8;if((y>p||z)&&(z?(p=k(n_bits=q),z=!1):(++n_bits,p=12==n_bits?4096:k(n_bits))),a==s){for(;0<x;)f(255&n,b),n>>=8,x-=8;j(b)}}var n,o,p,q,r,s,t=Math.max(2,e),u=new Uint8Array(256),v=new Int32Array(5003),w=new Int32Array(5003),x=0,y=0,z=!1;this.encode=function d(c){c.writeByte(t),remaining=a*b,curPixel=0,i(t+1,c),c.writeByte(0)}}var d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];b.exports=c},{}],3:[function(a,b,c){var d=Math.min;function e(a,c){var e=Math.abs;function f(){s=[],t=new Int32Array(256),u=new Int32Array(256),w=new Int32Array(256),x=new Int32Array(32);var a,b;for(a=0;a<256;a++)b=(a<<12)/256,s[a]=new Float64Array([b,b,b,0]),w[a]=256,u[a]=0}function g(){for(var a=0;a<256;a++)s[a][0]>>=4,s[a][1]>>=4,s[a][2]>>=4,s[a][3]=a}function h(a,c,d,b,e){s[c][0]-=a*(s[c][0]-d)/1024,s[c][1]-=a*(s[c][1]-b)/1024,s[c][2]-=a*(s[c][2]-e)/1024}function k(c,f,h,b,g){for(var i,l,n=e(f-c),o=d(f+c,256),q=f+1,r=f-1,t=1;q<o||r>n;)l=x[t++],q<o&&(i=s[q++],i[0]-=l*(i[0]-h)/262144,i[1]-=l*(i[1]-b)/262144,i[2]-=l*(i[2]-g)/262144),r>n&&(i=s[r--],i[0]-=l*(i[0]-h)/262144,i[1]-=l*(i[1]-b)/262144,i[2]-=l*(i[2]-g)/262144)}function l(a,b,c){var d,f,g,h,j,k=2147483647,l=k,m=-1,o=m;for(d=0;256>d;d++)f=s[d],g=e(f[0]-a)+e(f[1]-b)+e(f[2]-c),g<k&&(k=g,m=d),h=g-(u[d]>>12),h<l&&(l=h,o=d),j=w[d]>>10,w[d]-=j,u[d]+=j<<10;return w[m]+=64,u[m]-=65536,o}function m(){var a,b,c,d,e,f,g=0,h=0;for(a=0;256>a;a++){for(c=s[a],e=a,f=c[1],b=a+1;256>b;b++)d=s[b],d[1]<f&&(e=b,f=d[1]);if(d=s[e],a!=e&&(b=d[0],d[0]=c[0],c[0]=b,b=d[1],d[1]=c[1],c[1]=b,b=d[2],d[2]=c[2],c[2]=b,b=d[3],d[3]=c[3],c[3]=b),f!=g){for(t[g]=h+a>>1,b=g+1;b<f;b++)t[b]=a;g=f,h=a}}for(t[g]=h+255>>1,b=g+1;256>b;b++)t[b]=255}function n(c,b,d){for(var e,f,g,h=1e3,k=-1,l=t[b],m=l-1;l<256||0<=m;)256>l&&(f=s[l],g=f[1]-b,g>=h?l=256:(l++,0>g&&(g=-g),e=f[0]-c,0>e&&(e=-e),g+=e,g<h&&(e=f[2]-d,0>e&&(e=-e),g+=e,g<h&&(h=g,k=f[3])))),0<=m&&(f=s[m],g=b-f[1],g>=h?m=-1:(m--,0>g&&(g=-g),e=f[0]-c,0>e&&(e=-e),g+=e,g<h&&(e=f[2]-d,0>e&&(e=-e),g+=e,g<h&&(h=g,k=f[3]))));return k}function o(){var d,e=a.length,f=30+(c-1)/3,m=e/(3*c),n=~~(m/100),o=1024,p=2048,q=p>>6;for(1>=q&&(q=0),d=0;d<q;d++)x[d]=o*((q*q-d*d)*256/(q*q));var s;e<1509?(c=1,s=3):0==e%499?0==e%491?0==e%487?s=1509:s=1461:s=1473:s=1497;var t,u,v,w,y=0;for(d=0;d<m;)if(t=(255&a[y])<<4,u=(255&a[y+1])<<4,v=(255&a[y+2])<<4,w=l(t,u,v),h(o,w,t,u,v),0!==q&&k(q,w,t,u,v),y+=s,y>=e&&(y-=e),d++,0===n&&(n=1),0==d%n)for(o-=o/f,p-=p/30,q=p>>6,1>=q&&(q=0),w=0;w<q;w++)x[w]=o*(256*(q*q-w*w)/(q*q))}function p(){f(),o(),g(),m()}function q(){for(var a=[],b=[],c=0;c<256;c++)b[s[c][3]]=c;for(var d,e=0,f=0;f<256;f++)d=b[f],a[e++]=s[d][0],a[e++]=s[d][1],a[e++]=s[d][2];return a}var s,t,u,w,x;this.buildColormap=p,this.getColormap=q,this.lookupRGB=n}var f,g=100,h=256,i=h-1,j=4,k=16,l=1<<k,m=10,n=1<<m,o=10,p=l>>o,q=l<<m-o,r=h>>3,s=6,t=1<<s,u=r*t,v=30,w=10,x=1<<w,y=8,z=1<<y,A=w+y,B=1<<A,C=499,D=491,E=487,F=503,G=3*F;b.exports=e},{}],4:[function(a,b,c){var d,e;d=a("./GIFEncoder.js"),e=function(a){var b,c,e,f;return b=new d(a.width,a.height),0===a.index?b.writeHeader():b.firstFrame=!1,b.setTransparent(a.transparent),b.setRepeat(a.repeat),b.setDelay(a.delay),b.setQuality(a.quality),b.setDither(a.dither),b.setGlobalPalette(a.globalPalette),b.addFrame(a.data),a.last&&b.finish(),!0===a.globalPalette&&(a.globalPalette=b.getGlobalPalette()),e=b.stream(),a.data=e.pages,a.cursor=e.cursor,a.pageSize=e.constructor.pageSize,a.canTransfer?(f=function(){var b,d,e,f;for(e=a.data,f=[],b=0,d=e.length;b<d;b++)c=e[b],f.push(c.buffer);return f}(),self.postMessage(a,f)):self.postMessage(a)},self.onmessage=function(a){return e(a.data)}},{"./GIFEncoder.js":1}]},{},[4]);